<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redact PDF Online Free - Remove Sensitive Information | PDFrow</title>
    <meta name="description" content="Redact PDF files online for free. Remove sensitive content, personal information, and confidential data from your PDFs securely. Client-side processing ensures privacy.">
    <meta name="keywords" content="redact PDF, remove sensitive information, PDF redaction, black out PDF, censor PDF, hide PDF text, confidential PDF, secure PDF redaction, free PDF redact">
    <meta name="author" content="PDFrow">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow">

    <!-- Open Graph meta tags -->
    <meta property="og:title" content="Redact PDF Online Free - Remove Sensitive Information | PDFrow">
    <meta property="og:description" content="Redact PDF files online for free. Remove sensitive content, personal information, and confidential data from your PDFs securely.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pdfrow.com/redact-pdf">
    <meta property="og:image" content="https://pdfrow.com/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="PDFrow PDF Redactor - Remove Sensitive Information Online">
    <meta property="og:site_name" content="PDFrow">

    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Redact PDF Online Free - Remove Sensitive Information | PDFrow">
    <meta name="twitter:description" content="Redact PDF files online for free. Remove sensitive content, personal information, and confidential data from your PDFs securely.">
    <meta name="twitter:image" content="https://pdfrow.com/og-image.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://pdfrow.com/redact-pdf.html">

    <!-- Apple meta tags -->
    <meta name="application-name" content="PDFrow">
    <meta name="apple-mobile-web-app-title" content="PDFrow">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="auth.css">
    <link rel="stylesheet" href="url-import.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="theme-loader.js"></script>

    <!-- Logo Size Customization -->
    <style>
        .logo-image {
            width: 56px !important;
            height: 56px !important;
        }

        .logo-text {
            font-size: 1.6rem !important;
            font-weight: 600 !important;
        }

        .footer .logo-image {
            width: 48px !important;
            height: 48px !important;
        }

        .footer .logo-text {
            font-size: 1.3rem !important;
        }

        .logo {
            align-items: center !important;
            gap: 0.75rem !important;
        }
    </style>

    <!-- Page-specific styles -->
    <style>
        .page-header {
            position: relative;
            padding: 1rem 0 2rem 0;
            margin-top: 6rem;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            border-bottom: 1px solid var(--border-color);
        }

        .page-header-background {
            position: absolute;
            inset: 0;
            overflow: hidden;
        }

        .header-decoration {
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 200px;
            background: linear-gradient(135deg, var(--accent-primary) 10%, transparent 70%);
            opacity: 0.1;
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .page-header-content {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .breadcrumb-link {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .breadcrumb-link:hover {
            color: var(--accent-primary);
        }

        .breadcrumb-current {
            color: var(--text-primary);
            font-weight: 500;
        }

        .page-title-section {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .tool-icon-large {
            flex-shrink: 0;
        }

        .icon-background {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            box-shadow: 0 8px 32px rgba(var(--accent-primary-rgb), 0.3);
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
            line-height: 1.2;
        }

        .page-description {
            font-size: 1.125rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0;
            max-width: 600px;
        }

        .tool-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .feature-item:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .feature-item svg {
            color: var(--accent-primary);
            flex-shrink: 0;
        }

        .security-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            max-width: fit-content;
        }

        .security-badge svg {
            color: var(--accent-primary);
            flex-shrink: 0;
        }

        .workspace {
            display: none;
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
            gap: 2rem;
        }

        .workspace.active {
            display: grid;
            grid-template-columns: 350px 1fr;
        }

        .sidebar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .search-box {
            margin-bottom: 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .pattern-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .pattern-item {
            display: flex;
            align-items: center;
            padding: 0.875rem;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .pattern-item:hover {
            border-color: var(--accent-primary);
        }

        .pattern-item.selected {
            border-color: var(--accent-primary);
            background: rgba(76, 175, 80, 0.1);
        }

        .pattern-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.75rem;
            flex-shrink: 0;
        }

        .pattern-icon svg {
            color: white;
        }

        .pattern-info {
            flex: 1;
        }

        .pattern-name {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.2rem;
        }

        .pattern-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .pattern-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid var(--border-color);
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pattern-item.selected .pattern-checkbox {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .pattern-item.selected .pattern-checkbox::after {
            content: 'âœ“';
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .btn-find {
            padding: 0.875rem;
            background: #dc2626;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-find:hover:not(:disabled) {
            background: #b91c1c;
        }

        .btn-find:disabled {
            background: var(--border-color);
            cursor: not-allowed;
        }

        .btn-cancel {
            padding: 0.875rem;
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .matches-count {
            padding: 0.875rem;
            background: var(--bg-primary);
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .matches-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-primary);
            display: block;
            margin-bottom: 0.25rem;
        }

        .tool-mode {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: 8px;
        }

        .tool-mode-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }

        .mode-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .mode-btn {
            flex: 1;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mode-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .pdf-viewer {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .pdf-canvas-wrapper {
            position: relative;
            background: #525659;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 600px;
            margin-bottom: 1rem;
            overflow: auto;
        }

        .pdf-canvas-wrapper.manual-mode {
            cursor: crosshair;
        }

        #pdfCanvas {
            display: block;
            max-width: 100%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .redaction-box {
            position: absolute;
            background: rgba(220, 38, 38, 0.4);
            border: 2px solid #dc2626;
            pointer-events: none;
            z-index: 10;
            transition: all 0.2s ease;
        }

        .redaction-box:hover {
            background: rgba(220, 38, 38, 0.6);
            border-color: #991b1b;
            transform: scale(1.05);
        }

        .selection-box {
            position: absolute;
            background: rgba(76, 175, 80, 0.3);
            border: 2px dashed #4CAF50;
            pointer-events: none;
            z-index: 10;
        }

        .page-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-primary);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .page-controls button {
            padding: 0.5rem 1rem;
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        .page-controls button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-apply {
            width: 100%;
            padding: 1rem;
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
        }

        .btn-undo {
            width: 100%;
            padding: 0.75rem;
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 0.5rem;
        }

        .loading-state {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 2px dashed var(--accent-primary);
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .loading-state.active {
            display: flex;
        }

        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .validation-error {
            display: none;
            padding: 1rem;
            background: #fef2f2;
            border-left: 4px solid #dc2626;
            border-radius: 6px;
            color: #dc2626;
            margin-top: 1rem;
        }

        .validation-error.active {
            display: block;
        }

        .dark-mode .validation-error {
            background: #1f1818;
            color: #f87171;
        }

        @media (max-width: 1024px) {
            .workspace.active {
                grid-template-columns: 1fr;
            }
            .sidebar {
                position: relative;
                top: 0;
            }
        }

        /* Success State and Continue Workflow */
        .success-state {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            padding: 3rem 2rem;
            max-width: 800px;
            margin: 2rem auto;
            background: var(--bg-primary);
        }

        .success-state.active {
            display: flex;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: successPop 0.5s ease;
        }

        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .success-message h3 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
            text-align: center;
        }

        .success-message p {
            color: var(--text-secondary);
            margin: 0;
            text-align: center;
        }

        .success-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn-secondary {
            padding: 0.875rem 1.5rem;
            background: transparent;
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--accent-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .continue-section {
            width: 100%;
            max-width: 600px;
            margin-top: 1rem;
            padding-top: 2rem;
            border-top: 1px solid #374151;
        }

        .continue-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #e5e7eb;
            margin: 0 0 1rem 0;
            text-align: center;
        }

        .continue-tools {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .continue-tool-btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
            background: #1f2937;
            border: 1px solid #374151;
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #e5e7eb;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .continue-tool-btn:hover {
            background: #374151;
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        }

        .continue-tool-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
        }

        .continue-tool-btn span {
            flex: 1;
            text-align: left;
        }

        .continue-arrow {
            stroke: #9ca3af;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .continue-tool-btn:hover .continue-arrow {
            transform: translateX(3px);
            stroke: #4CAF50;
        }

        /* Light mode adjustments */
        body:not(.dark-mode) .continue-section {
            border-top-color: #d1d5db;
        }

        body:not(.dark-mode) .continue-title {
            color: #374151;
        }

        body:not(.dark-mode) .continue-tool-btn {
            background: #ffffff;
            border-color: #e5e7eb;
            color: #374151;
        }

        body:not(.dark-mode) .continue-tool-btn:hover {
            background: #f9fafb;
            border-color: #4CAF50;
        }

        body:not(.dark-mode) .continue-arrow {
            stroke: #6b7280;
        }

        body:not(.dark-mode) .continue-tool-btn:hover .continue-arrow {
            stroke: #4CAF50;
        }
    </style>
</head>
<body class="dark-mode">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-container">
                <a href="/" class="logo">
                    <div class="logo-icon">
                        <img src="Official Logo PDFrow.png" alt="PDFrow Logo" class="logo-image">
                    </div>
                    <h1 class="logo-text">PDFrow</h1>
                </a>

                <div class="nav-links">
                    <a href="/" class="nav-link" data-translate="nav_tools">Tools</a>
                    <a href="/" class="nav-link" data-translate="nav_features">Features</a>
                    <a href="/" class="nav-link" data-translate="nav_how_it_works">How It Works</a>
                    <a href="/" class="nav-link" data-translate="nav_blog">Blog</a>
                    <a href="/" class="nav-link" data-translate="nav_faq">FAQ</a>
                </div>

                <div class="nav-actions">
                    <!-- Auth Buttons (shown when not logged in) -->
                    <div id="auth-buttons" class="auth-buttons">
                        <button class="btn-auth btn-login" id="loginBtn">Login</button>
                        <button class="btn-auth btn-signup" id="signupBtn">Sign Up</button>
                    </div>

                    <!-- User Menu (shown when logged in) -->
                    <div id="user-menu" class="user-menu" style="display: none;">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <span class="user-email">user@example.com</span>
                        <div class="user-dropdown">
                            <button class="dropdown-item" id="profileBtn">Profile</button>
                            <button class="dropdown-item" id="logoutBtn">Logout</button>
                        </div>
                    </div>

                    <div class="theme-toggle" id="theme-toggle">
                    <div class="theme-toggle-track">
                        <div class="theme-toggle-thumb">
                            <svg class="theme-icon sun-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-label="Light theme">
                                <circle cx="12" cy="12" r="5"/>
                                <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                            </svg>
                            <svg class="theme-icon dimmed-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-label="Dimmed theme">
                                <path d="M12 3a6.364 6.364 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                                <path d="M20 3v4m-2-2h4"/>
                            </svg>
                            <svg class="theme-icon moon-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-label="Dark theme">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </nav>

        <!-- Page Header -->
        <header class="page-header">
            <div class="page-header-background">
                <div class="header-decoration"></div>
            </div>
            <div class="page-header-content">
                <nav class="breadcrumb">
                    <a href="/" class="breadcrumb-link">Home</a>
                    <span>/</span>
                    <span class="breadcrumb-current">Redact PDF</span>
                </nav>

                <div class="page-title-section">
                    <div class="tool-icon-large">
                        <div class="icon-background">
                            <img src="Redact-pdf.png" alt="Redact PDF Icon" style="width: 50px; height: 50px;">
                        </div>
                    </div>
                    <div>
                        <h1 class="page-title" data-translate="page_title">Redact PDF</h1>
                        <p class="page-description" data-translate="page_description">Remove sensitive information from your PDFs - auto-detect or manually select areas to redact</p>
                    </div>
                </div>

                <div class="tool-features">
                    <div class="feature-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                            <polyline points="7.5 4.21 12 6.81 16.5 4.21"/>
                            <polyline points="7.5 19.79 7.5 14.6 3 12"/>
                            <polyline points="21 12 16.5 14.6 16.5 19.79"/>
                        </svg>
                        <span data-translate="feature_auto_detect">Auto-detect sensitive data</span>
                    </div>
                    <div class="feature-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
                            <line x1="7" y1="7" x2="7.01" y2="7"/>
                        </svg>
                        <span data-translate="feature_manual_selection">Manual selection mode</span>
                    </div>
                    <div class="feature-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                        <span data-translate="feature_secure_private">100% secure & private</span>
                    </div>
                    <div class="feature-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                        <span data-translate="feature_fast_processing">Fast processing</span>
                    </div>
                </div>

                <div class="security-badge">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                    <span data-translate="security_badge">Your files are processed locally in your browser. They never leave your device.</span>
                </div>
            </div>
        </header>

        <section class="tools-section">
            <div class="tools-grid">
                <div class="tool-card active">
                    <div class="privacy-badge">
                        <span class="lock-icon">ðŸ”’</span>
                        <span data-translate="privacy_badge">100% client-side. Files never leave your device.</span>
                    </div>

                    <!-- Upload Method Toggle -->
                    <div class="upload-method-toggle">
                        <button class="upload-method-btn active" data-method="local" type="button">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" y1="3" x2="12" y2="15"/>
                            </svg>
                            <span data-translate="upload_from_computer">Upload from Computer</span>
                        </button>
                        <button class="upload-method-btn" data-method="url" type="button">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                            </svg>
                            <span data-translate="import_from_url">Import from URL</span>
                        </button>
                    </div>

                    <!-- URL Import Section -->
                    <div class="url-import-section" id="url-import-section">
                        <div class="url-input-container">
                            <svg class="url-input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
                            </svg>
                            <input
                                type="url"
                                class="url-input"
                                id="url-input"
                                data-translate="url_placeholder"
                                placeholder="Paste Dropbox or Google Drive link here..."
                                aria-label="Enter file URL from Dropbox or Google Drive"
                            >
                        </div>
                        <button class="url-import-btn" id="url-import-btn" type="button">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            <span data-translate="import_file_btn">Import File</span>
                        </button>

                        <div class="download-progress" id="download-progress">
                            <div class="progress-info">
                                <span id="download-status" data-translate="download_status">Downloading...</span>
                                <span id="download-size">0 MB / 0 MB</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="download-progress-fill"></div>
                            </div>
                        </div>

                        <div class="validation-error" id="url-error"></div>
                    </div>

                    <div class="upload-area" id="upload-area">
                        <input type="file" class="file-input" id="file-input-redact" accept=".pdf" style="position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer; z-index: 10;">
                        <div class="upload-icon" style="pointer-events: none;">
                            <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="1.5">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" y1="3" x2="12" y2="15"/>
                            </svg>
                        </div>
                        <div class="upload-text" style="pointer-events: none;">
                            <p data-translate="upload_drop_text">Click to select or drag and drop your PDF file</p>
                            <p class="upload-subtext" data-translate="upload_file_info">PDF files â€¢ Max 50MB</p>
                        </div>
                    </div>

                    <div class="loading-state" id="uploadLoading">
                        <div class="loading-spinner"></div>
                        <span>Loading your PDF...</span>
                    </div>

                    <div class="validation-error" id="validationError"></div>
                </div>
            </div>
        </section>

        <div class="workspace" id="workspace">
            <aside class="sidebar">
                <h2 class="sidebar-title" data-translate="redaction_tools_title">Redaction Tools</h2>

                <div class="tool-mode">
                    <div class="tool-mode-title">Select Mode:</div>
                    <div class="mode-buttons">
                        <button class="mode-btn" id="autoModeBtn">Auto Detect</button>
                        <button class="mode-btn active" id="manualModeBtn">Manual Select</button>
                    </div>
                </div>

                <div id="autoMode" style="display: none;">
                    <div class="search-box">
                        <input type="text" class="search-input" id="searchInput" placeholder="Search text to redact...">
                    </div>

                    <div class="pattern-list">
                        <div class="pattern-item" data-pattern="text">
                            <div class="pattern-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="4" y1="9" x2="20" y2="9"/>
                                    <line x1="4" y1="15" x2="20" y2="15"/>
                                </svg>
                            </div>
                            <div class="pattern-info">
                                <div class="pattern-name">Text</div>
                                <div class="pattern-desc">Custom search</div>
                            </div>
                            <div class="pattern-checkbox"></div>
                        </div>

                        <div class="pattern-item" data-pattern="creditcard">
                            <div class="pattern-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="1" y="4" width="22" height="16" rx="2"/>
                                    <line x1="1" y1="10" x2="23" y2="10"/>
                                </svg>
                            </div>
                            <div class="pattern-info">
                                <div class="pattern-name">Credit Card</div>
                                <div class="pattern-desc">Card numbers</div>
                            </div>
                            <div class="pattern-checkbox"></div>
                        </div>

                        <div class="pattern-item" data-pattern="phone">
                            <div class="pattern-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                </svg>
                            </div>
                            <div class="pattern-info">
                                <div class="pattern-name">Phone Number</div>
                                <div class="pattern-desc">All formats</div>
                            </div>
                            <div class="pattern-checkbox"></div>
                        </div>

                        <div class="pattern-item" data-pattern="email">
                            <div class="pattern-icon">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                    <polyline points="22,6 12,13 2,6"/>
                                </svg>
                            </div>
                            <div class="pattern-info">
                                <div class="pattern-name">Email</div>
                                <div class="pattern-desc">Email addresses</div>
                            </div>
                            <div class="pattern-checkbox"></div>
                        </div>
                    </div>

                    <button class="btn-find" id="findBtn" disabled>Find & Redact</button>
                </div>

                <div id="manualMode">
                    <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">
                        Click and drag on the PDF to select areas you want to redact. They will appear in red.
                    </p>
                    <button class="btn-undo" id="undoBtn" disabled>Undo Last Selection</button>
                </div>

                <div class="matches-count" id="matchesCount" style="display: none;">
                    <span class="matches-number" id="matchesNumber">0</span>
                    <span>selections made</span>
                </div>

                <button class="btn-cancel" onclick="location.reload()">Cancel</button>
            </aside>

            <main class="pdf-viewer">
                <div class="pdf-canvas-wrapper manual-mode" id="canvasWrapper">
                    <canvas id="pdfCanvas"></canvas>
                </div>

                <div class="page-controls">
                    <button id="prevPage">Previous</button>
                    <span>Page <span id="pageNum">1</span> of <span id="pageCount">1</span></span>
                    <button id="nextPage">Next</button>
                </div>

                <button class="btn-apply" id="applyBtn" style="display: none;">Apply Redaction & Download</button>

                <div class="loading-state" id="processingState">
                    <div class="loading-spinner"></div>
                    <span>Applying redactions...</span>
                </div>
            </main>
        </div>

        <!-- Success State (Outside workspace) -->
        <div class="success-state" id="successState">
            <div class="success-icon">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
            </div>

            <div class="success-message">
                <h3>PDF Successfully Redacted!</h3>
                <p>Your redacted PDF is ready for download</p>
            </div>

            <div class="success-actions">
                <button class="btn-primary" id="downloadRedactedBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Download PDF
                </button>
                <button class="btn-secondary" id="redactAnotherBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <line x1="7" y1="10" x2="17" y2="10"/>
                        <line x1="7" y1="14" x2="13" y2="14"/>
                    </svg>
                    Select Another File
                </button>
            </div>

            <!-- Continue to other tools -->
            <div class="continue-section">
                <h4 class="continue-title">Continue with...</h4>
                <div class="continue-tools">
                    <button class="continue-tool-btn" data-tool="compress-pdf">
                        <div class="continue-tool-icon">
                            <img src="compress-pdf-png.png" alt="Compress PDF" style="width: 35px; height: 35px; object-fit: contain;">
                        </div>
                        <span>Compress PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="merge-pdf">
                        <div class="continue-tool-icon">
                            <img src="merge-pdf.png" alt="Merge PDF" style="width: 35px; height: 35px; object-fit: contain;">
                        </div>
                        <span>Merge PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="protect-pdf">
                        <div class="continue-tool-icon">
                            <img src="protect-pdf.png" alt="Protect PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Protect PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="split-pdf">
                        <div class="continue-tool-icon">
                            <img src="split-pdf.png" alt="Split PDF" style="width: 35px; height: 35px; object-fit: contain;">
                        </div>
                        <span>Split PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="rotate-pdf">
                        <div class="continue-tool-icon">
                            <img src="rotate-pdf.png" alt="Rotate PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Rotate PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="edit-pdf">
                        <div class="continue-tool-icon">
                            <img src="edit-pdf-png.png" alt="Edit PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Edit PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="sign-pdf">
                        <div class="continue-tool-icon">
                            <img src="sign-pdf.png" alt="Sign PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Sign PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="organize-pdf">
                        <div class="continue-tool-icon">
                            <img src="organize-pdf.png" alt="Organize PDF" style="width: 45px; height: 45px; object-fit: contain;">
                        </div>
                        <span>Organize PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="crop-pdf">
                        <div class="continue-tool-icon">
                            <img src="crop-pdf.png" alt="Crop PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Crop PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="add-watermark">
                        <div class="continue-tool-icon">
                            <img src="add-watermark.png" alt="Add Watermark" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Add Watermark</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="add-page-numbers">
                        <div class="continue-tool-icon">
                            <img src="add-page-numbers.png" alt="Add Page Numbers" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Add Page Numbers</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="pdf-to-jpg">
                        <div class="continue-tool-icon">
                            <img src="pdf-to-jpg.png" alt="PDF to JPG" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>PDF to JPG</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="pdf-to-word">
                        <div class="continue-tool-icon">
                            <img src="pdf-to-word.png" alt="PDF to Word" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>PDF to Word</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="pdf-to-excel">
                        <div class="continue-tool-icon">
                            <img src="pdf-to-excel.png" alt="PDF to Excel" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>PDF to Excel</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>

                    <button class="continue-tool-btn" data-tool="repair-pdf">
                        <div class="continue-tool-icon">
                            <img src="repair-pdf.png" alt="Repair PDF" style="width: 30px; height: 30px; object-fit: contain;">
                        </div>
                        <span>Repair PDF</span>
                        <svg class="continue-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="9 18 15 12 9 6"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-main">
                    <div class="footer-brand">
                        <div class="logo">
                            <div class="logo-icon">
                                <img src="Official Logo PDFrow.png" alt="PDFrow Logo" class="logo-image">
                            </div>
                            <h3 class="logo-text">PDFrow</h3>
                        </div>
                        <p class="footer-description" data-translate="footer_description">
                            Next-generation document processing platform. Fast, secure, and always free.
                        </p>
                        <div class="footer-social">
                            <a href="https://instagram.com/pdfrow" class="social-link" aria-label="Follow us on Instagram">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
                                    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
                                    <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
                                </svg>
                            </a>
                            <a href="mailto:contact@pdfrow.com" class="social-link" aria-label="Contact us via email">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                    <polyline points="22,6 12,13 2,6"/>
                                </svg>
                            </a>
                        </div>
                    </div>

                    <div class="footer-links">
                        <div class="footer-column">
                            <h4 data-translate="footer_tools_title">Tools</h4>
                            <ul>
                                <li><a href="compress-pdf.html" data-translate="footer_pdf_compressor">Compress PDF</a></li>
                                <li><a href="merge-pdf.html" data-translate="footer_pdf_merger">Merge PDF</a></li>
                                <li><a href="split-pdf.html" data-translate="footer_pdf_splitter">Split PDF</a></li>
                                <li><a href="redact-pdf.html">Redact PDF</a></li>
                            </ul>
                        </div>

                        <div class="footer-column">
                            <h4 data-translate="footer_support_title">Support</h4>
                            <ul>
                                <li><a href="/" data-translate="footer_faq">FAQ</a></li>
                                <li><a href="/" data-translate="footer_how_it_works">How It Works</a></li>
                                <li><a href="/" id="footerContactLink" data-translate="footer_contact">Contact</a></li>
                                <li><a href="terms-conditions.html" data-translate="footer_terms">Terms & Conditions</a></li>
                                <li><a href="privacy-policy.html" data-translate="footer_privacy">Privacy Policy</a></li>
                            </ul>
                        </div>

                        <div class="footer-column">
                            <h4 data-translate="language">Language</h4>
                            <div class="language-dropdown">
                                <button class="language-btn" id="languageBtn">
                                    <span class="flag" id="currentFlag">ðŸ‡ºðŸ‡¸</span>
                                    <span id="currentLang">English</span>
                                    <svg class="dropdown-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                        <polyline points="6,9 12,15 18,9"/>
                                    </svg>
                                </button>
                                <div class="language-menu" id="languageMenu">
                                    <div class="language-item" data-lang="en" data-flag="ðŸ‡ºðŸ‡¸">
                                        <span class="flag">ðŸ‡ºðŸ‡¸</span>
                                        <span>English</span>
                                    </div>
                                    <div class="language-item" data-lang="es" data-flag="ðŸ‡ªðŸ‡¸">
                                        <span class="flag">ðŸ‡ªðŸ‡¸</span>
                                        <span>EspaÃ±ol</span>
                                    </div>
                                    <div class="language-item" data-lang="fr" data-flag="ðŸ‡«ðŸ‡·">
                                        <span class="flag">ðŸ‡«ðŸ‡·</span>
                                        <span>FranÃ§ais</span>
                                    </div>
                                    <div class="language-item" data-lang="de" data-flag="ðŸ‡©ðŸ‡ª">
                                        <span class="flag">ðŸ‡©ðŸ‡ª</span>
                                        <span>Deutsch</span>
                                    </div>
                                    <div class="language-item" data-lang="it" data-flag="ðŸ‡®ðŸ‡¹">
                                        <span class="flag">ðŸ‡®ðŸ‡¹</span>
                                        <span>Italiano</span>
                                    </div>
                                    <div class="language-item" data-lang="tr" data-flag="ðŸ‡¹ðŸ‡·">
                                        <span class="flag">ðŸ‡¹ðŸ‡·</span>
                                        <span>TÃ¼rkÃ§e</span>
                                    </div>
                                    <div class="language-item" data-lang="pt" data-flag="ðŸ‡µðŸ‡¹">
                                        <span class="flag">ðŸ‡µðŸ‡¹</span>
                                        <span>PortuguÃªs</span>
                                    </div>
                                    <div class="language-item" data-lang="ru" data-flag="ðŸ‡·ðŸ‡º">
                                        <span class="flag">ðŸ‡·ðŸ‡º</span>
                                        <span>Ð ÑƒÑÑÐºÐ¸Ð¹</span>
                                    </div>
                                    <div class="language-item" data-lang="zh" data-flag="ðŸ‡¨ðŸ‡³">
                                        <span class="flag">ðŸ‡¨ðŸ‡³</span>
                                        <span>ä¸­æ–‡</span>
                                    </div>
                                    <div class="language-item" data-lang="ja" data-flag="ðŸ‡¯ðŸ‡µ">
                                        <span class="flag">ðŸ‡¯ðŸ‡µ</span>
                                        <span>æ—¥æœ¬èªž</span>
                                    </div>
                                    <div class="language-item" data-lang="ar" data-flag="ðŸ‡¸ðŸ‡¦">
                                        <span class="flag">ðŸ‡¸ðŸ‡¦</span>
                                        <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                                    </div>
                                    <div class="language-item" data-lang="hi" data-flag="ðŸ‡®ðŸ‡³">
                                        <span class="flag">ðŸ‡®ðŸ‡³</span>
                                        <span>à¤¹à¤¿à¤¨à¥à¤¦à¥€</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="footer-bottom">
                    <p data-translate="footer_copyright">&copy; <span id="current-year">2025</span> PDFrow. All rights reserved. Made with â¤ï¸ for document processing.</p>
                </div>
            </div>
        </footer>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="auth.js"></script>
    <script src="support.js"></script>
    <script src="script.js"></script>
    <script src="theme.js"></script>
    <script src="url-import.js"></script>
    <script src="redact-pdf-translations.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        const PATTERNS = {
            creditcard: /\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b/gi,
            phone: /\b\d{3}[-.\s]?\d{3}[-.\s]?\d{4}\b/gi,
            email: /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/gi
        };

        let pdfDoc = null;
        let currentPage = 1;
        let scale = 1.5;
        let redactionBoxes = {};
        let currentFile = null;
        let selectedPatterns = new Set();
        let searchText = '';
        let isManualMode = true;
        let isDrawing = false;
        let startX, startY;
        let currentSelectionBox = null;

        // DOM elements (will be initialized in DOMContentLoaded)
        let uploadArea, fileInput, uploadLoading, validationError, workspace, canvas, ctx, canvasWrapper;
        let searchInput, findBtn, applyBtn, undoBtn, processingState, matchesCount, matchesNumber;
        let autoModeBtn, manualModeBtn, autoMode, manualMode;
        let successState, redactedFile;

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize translations
            if (typeof initializeTranslations === 'function') {
                initializeTranslations();
            }

            // Initialize URL Import
            if (typeof initializeURLImport === 'function') {
                initializeURLImport('pdf');
            }

            // Initialize DOM elements
            uploadArea = document.getElementById('upload-area');
            fileInput = document.getElementById('file-input-redact');
            uploadLoading = document.getElementById('uploadLoading');
            validationError = document.getElementById('validationError');
            workspace = document.getElementById('workspace');
            canvas = document.getElementById('pdfCanvas');
            ctx = canvas.getContext('2d');
            canvasWrapper = document.getElementById('canvasWrapper');
            searchInput = document.getElementById('searchInput');
            findBtn = document.getElementById('findBtn');
            applyBtn = document.getElementById('applyBtn');
            undoBtn = document.getElementById('undoBtn');
            processingState = document.getElementById('processingState');
            matchesCount = document.getElementById('matchesCount');
            matchesNumber = document.getElementById('matchesNumber');
            autoModeBtn = document.getElementById('autoModeBtn');
            manualModeBtn = document.getElementById('manualModeBtn');
            autoMode = document.getElementById('autoMode');
            manualMode = document.getElementById('manualMode');
            successState = document.getElementById('successState');

            // Define handleFile function FIRST
            async function handleFile(file) {
            console.log('handleFile called with:', file ? file.name : 'no file');

            // Clear any previous errors
            validationError.classList.remove('active');
            validationError.textContent = '';

            if (!file || file.type !== 'application/pdf') {
                console.log('Validation failed: not a PDF');
                validationError.textContent = 'Please select a valid PDF file';
                validationError.classList.add('active');
                return;
            }

            if (file.size > 50 * 1024 * 1024) {
                console.log('Validation failed: file too large');
                validationError.textContent = 'File size must be less than 50MB';
                validationError.classList.add('active');
                return;
            }

            console.log('File validation passed, processing...');
            currentFile = file;

            // Hide upload area and URL import section
            uploadArea.style.display = 'none';
            const urlImportSection = document.getElementById('url-import-section');
            if (urlImportSection) {
                urlImportSection.style.display = 'none';
            }
            const uploadMethodToggle = document.querySelector('.upload-method-toggle');
            if (uploadMethodToggle) {
                uploadMethodToggle.style.display = 'none';
            }

            uploadLoading.classList.add('active');

            try {
                const arrayBuffer = await file.arrayBuffer();
                pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;

                document.getElementById('pageCount').textContent = pdfDoc.numPages;

                // Initialize redaction boxes for all pages
                for (let i = 1; i <= pdfDoc.numPages; i++) {
                    redactionBoxes[i] = [];
                }

                uploadLoading.classList.remove('active');
                workspace.classList.add('active');

                await renderPage(currentPage);
            } catch (error) {
                console.error('Error loading PDF:', error);
                uploadLoading.classList.remove('active');
                validationError.textContent = 'Error loading PDF: ' + error.message;
                validationError.classList.add('active');
            }
        }

        // Now set up event listeners AFTER handleFile is defined
        // Mode switching
        autoModeBtn.addEventListener('click', () => {
            isManualMode = false;
            autoModeBtn.classList.add('active');
            manualModeBtn.classList.remove('active');
            autoMode.style.display = 'block';
            manualMode.style.display = 'none';
            canvasWrapper.classList.remove('manual-mode');
        });

        manualModeBtn.addEventListener('click', () => {
            isManualMode = true;
            manualModeBtn.classList.add('active');
            autoModeBtn.classList.remove('active');
            manualMode.style.display = 'block';
            autoMode.style.display = 'none';
            canvasWrapper.classList.add('manual-mode');
        });

        // Upload handling - DIRECT implementation
        fileInput.addEventListener('change', function(e) {
            console.log('File input change event fired');
            const files = e.target.files;
            if (files && files.length > 0) {
                console.log('File selected:', files[0].name);
                handleFile(files[0]);
            }
        });

        // Drag and drop on the upload area
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files && files.length > 0) {
                handleFile(files[0]);
            }
        });

        async function renderPage(num) {
            try {
                const page = await pdfDoc.getPage(num);
                const viewport = page.getViewport({ scale: scale });

                canvas.height = viewport.height;
                canvas.width = viewport.width;

                await page.render({
                    canvasContext: ctx,
                    viewport: viewport
                }).promise;

                document.getElementById('pageNum').textContent = num;
                document.getElementById('prevPage').disabled = num <= 1;
                document.getElementById('nextPage').disabled = num >= pdfDoc.numPages;

                renderRedactionBoxes(num);
            } catch (error) {
                console.error('Error rendering page:', error);
            }
        }

        function renderRedactionBoxes(pageNum) {
            document.querySelectorAll('.redaction-box').forEach(box => box.remove());

            const boxes = redactionBoxes[pageNum] || [];
            boxes.forEach((box, index) => {
                const div = document.createElement('div');
                div.className = 'redaction-box';
                div.style.left = box.x + 'px';
                div.style.top = box.y + 'px';
                div.style.width = box.width + 'px';
                div.style.height = box.height + 'px';

                // Make removable boxes clickable
                if (box.removable) {
                    div.style.pointerEvents = 'auto';
                    div.style.cursor = 'pointer';
                    div.title = 'Click to remove this redaction';
                    div.dataset.index = index;

                    div.addEventListener('click', (e) => {
                        e.stopPropagation();
                        // Remove this specific box
                        redactionBoxes[currentPage].splice(index, 1);
                        renderRedactionBoxes(currentPage);
                        console.log(`Removed redaction box at index ${index}`);
                    });
                }

                canvasWrapper.appendChild(div);
            });

            updateMatchCount();
        }

        function updateMatchCount() {
            let total = 0;
            for (let page in redactionBoxes) {
                total += redactionBoxes[page].length;
            }

            matchesNumber.textContent = total;
            matchesCount.style.display = total > 0 ? 'block' : 'none';
            applyBtn.style.display = total > 0 ? 'block' : 'none';
            undoBtn.disabled = redactionBoxes[currentPage].length === 0;
        }

        // Manual selection
        canvasWrapper.addEventListener('mousedown', (e) => {
            if (!isManualMode || e.target !== canvas) return;

            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            startX = e.clientX - rect.left;
            startY = e.clientY - rect.top;

            currentSelectionBox = document.createElement('div');
            currentSelectionBox.className = 'selection-box';
            currentSelectionBox.style.left = startX + 'px';
            currentSelectionBox.style.top = startY + 'px';
            canvasWrapper.appendChild(currentSelectionBox);
        });

        canvasWrapper.addEventListener('mousemove', (e) => {
            if (!isDrawing || !currentSelectionBox) return;

            const rect = canvas.getBoundingClientRect();
            const currentX = e.clientX - rect.left;
            const currentY = e.clientY - rect.top;

            const width = Math.abs(currentX - startX);
            const height = Math.abs(currentY - startY);
            const left = Math.min(startX, currentX);
            const top = Math.min(startY, currentY);

            currentSelectionBox.style.left = left + 'px';
            currentSelectionBox.style.top = top + 'px';
            currentSelectionBox.style.width = width + 'px';
            currentSelectionBox.style.height = height + 'px';
        });

        canvasWrapper.addEventListener('mouseup', (e) => {
            if (!isDrawing || !currentSelectionBox) return;

            const width = parseFloat(currentSelectionBox.style.width);
            const height = parseFloat(currentSelectionBox.style.height);

            if (width > 5 && height > 5) {
                redactionBoxes[currentPage].push({
                    x: parseFloat(currentSelectionBox.style.left),
                    y: parseFloat(currentSelectionBox.style.top),
                    width: width,
                    height: height
                });
            }

            currentSelectionBox.remove();
            currentSelectionBox = null;
            isDrawing = false;

            renderRedactionBoxes(currentPage);
        });

        // Undo
        undoBtn.addEventListener('click', () => {
            if (redactionBoxes[currentPage].length > 0) {
                redactionBoxes[currentPage].pop();
                renderRedactionBoxes(currentPage);
            }
        });

        // Pattern selection
        document.querySelectorAll('.pattern-item').forEach(item => {
            item.addEventListener('click', () => {
                const pattern = item.dataset.pattern;

                if (item.classList.contains('selected')) {
                    item.classList.remove('selected');
                    selectedPatterns.delete(pattern);
                } else {
                    item.classList.add('selected');
                    selectedPatterns.add(pattern);
                }

                findBtn.disabled = selectedPatterns.size === 0 && !searchInput.value.trim();
            });
        });

        searchInput.addEventListener('input', () => {
            searchText = searchInput.value.trim();
            findBtn.disabled = selectedPatterns.size === 0 && searchText === '';
        });

        // Auto find
        findBtn.addEventListener('click', async () => {
            findBtn.disabled = true;
            findBtn.textContent = 'Searching...';

            try {
                let totalMatches = 0;

                for (let pageNum = 1; pageNum <= pdfDoc.numPages; pageNum++) {
                    const page = await pdfDoc.getPage(pageNum);
                    const textContent = await page.getTextContent();
                    const viewport = page.getViewport({ scale: scale });

                    console.log(`Page ${pageNum} has ${textContent.items.length} text items`);

                    textContent.items.forEach(item => {
                        const text = item.str;
                        if (!text) return;

                        const transform = item.transform;
                        const x = transform[4] * scale;
                        const y = transform[5] * scale;
                        const fontSize = Math.sqrt((transform[2] * transform[2]) + (transform[3] * transform[3]));
                        const textHeight = fontSize * scale;
                        const fullTextWidth = item.width * scale;

                        // For custom text search - find exact word positions
                        if (selectedPatterns.has('text') && searchText) {
                            const regex = new RegExp(searchText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                            let match;

                            while ((match = regex.exec(text)) !== null) {
                                const matchStart = match.index;
                                const matchEnd = matchStart + match[0].length;

                                // Calculate position and width of matched word
                                const charWidthAvg = fullTextWidth / text.length;
                                const matchX = x + (matchStart * charWidthAvg);
                                const matchWidth = match[0].length * charWidthAvg;

                                // Add generous padding to ensure full coverage (30% on each side)
                                const padding = matchWidth * 0.3;
                                const paddedX = matchX - padding;
                                const paddedWidth = matchWidth + (padding * 2);

                                const canvasX = paddedX;
                                const canvasY = viewport.height - y - textHeight;

                                console.log(`MATCH FOUND (text): "${match[0]}" at position ${matchStart}, width: ${paddedWidth}`);

                                redactionBoxes[pageNum].push({
                                    x: canvasX,
                                    y: canvasY,
                                    width: paddedWidth,
                                    height: textHeight,
                                    removable: true
                                });
                                totalMatches++;
                            }
                        }

                        // For pattern-based search (email, phone, credit card)
                        selectedPatterns.forEach(patternName => {
                            if (patternName === 'text') return;

                            const pattern = PATTERNS[patternName];
                            if (!pattern) return;

                            const regex = new RegExp(pattern);
                            let match;

                            while ((match = regex.exec(text)) !== null) {
                                const matchStart = match.index;
                                const matchEnd = matchStart + match[0].length;

                                // Calculate position and width of matched pattern
                                const charWidthAvg = fullTextWidth / text.length;
                                const matchX = x + (matchStart * charWidthAvg);
                                const matchWidth = match[0].length * charWidthAvg;

                                // Add generous padding to ensure full coverage (30% on each side)
                                const padding = matchWidth * 0.3;
                                const paddedX = matchX - padding;
                                const paddedWidth = matchWidth + (padding * 2);

                                const canvasX = paddedX;
                                const canvasY = viewport.height - y - textHeight;

                                console.log(`MATCH FOUND (${patternName}): "${match[0]}" at position ${matchStart}, width: ${paddedWidth}`);

                                redactionBoxes[pageNum].push({
                                    x: canvasX,
                                    y: canvasY,
                                    width: paddedWidth,
                                    height: textHeight,
                                    removable: true
                                });
                                totalMatches++;
                            }
                        });
                    });
                }

                console.log('Total matches:', totalMatches);

                if (totalMatches > 0) {
                    renderRedactionBoxes(currentPage);
                    alert(`Found ${totalMatches} matches! Click any red box to remove it.`);
                } else {
                    alert('No matches found. Try manual selection or different search terms.');
                }

            } catch (error) {
                console.error('Error finding matches:', error);
                alert('Error searching PDF: ' + error.message);
            } finally {
                findBtn.disabled = false;
                findBtn.textContent = 'Find & Redact';
            }
        });

        // Page navigation
        document.getElementById('prevPage').addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                renderPage(currentPage);
            }
        });

        document.getElementById('nextPage').addEventListener('click', () => {
            if (currentPage < pdfDoc.numPages) {
                currentPage++;
                renderPage(currentPage);
            }
        });

        // Apply redaction
        applyBtn.addEventListener('click', async () => {
            applyBtn.style.display = 'none';
            processingState.style.display = 'flex';

            try {
                const arrayBuffer = await currentFile.arrayBuffer();
                const pdfLibDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                const pages = pdfLibDoc.getPages();

                for (let pageNum = 1; pageNum <= pdfDoc.numPages; pageNum++) {
                    const boxes = redactionBoxes[pageNum] || [];
                    if (boxes.length === 0) continue;

                    const page = pages[pageNum - 1];
                    const { height: pageHeight, width: pageWidth } = page.getSize();

                    boxes.forEach(box => {
                        // Convert canvas coordinates to PDF coordinates
                        // Canvas: Y=0 at top, increases down
                        // PDF: Y=0 at bottom, increases up
                        // box.x, box.y are in canvas pixels, need to convert to PDF points

                        const pdfX = box.x / scale;
                        const pdfWidth = box.width / scale;
                        const pdfHeight = box.height / scale;

                        // PDF Y is measured from bottom, so flip it
                        // box.y is distance from top of canvas
                        // PDF Y (bottom-left of rectangle) = pageHeight - (top of box) - height
                        const pdfY = pageHeight - (box.y / scale) - pdfHeight;

                        // Add generous extra padding to ensure full coverage of colored text
                        const extraPadding = 5; // 5 points extra padding
                        const finalX = pdfX - extraPadding;
                        const finalY = pdfY - extraPadding;
                        const finalWidth = pdfWidth + (extraPadding * 2);
                        const finalHeight = pdfHeight + (extraPadding * 2);

                        console.log(`Canvas: x=${box.x}, y=${box.y}, w=${box.width}, h=${box.height}`);
                        console.log(`PDF: x=${finalX}, y=${finalY}, w=${finalWidth}, h=${finalHeight}`);

                        // Draw thick black rectangle with thick border for complete coverage
                        page.drawRectangle({
                            x: finalX,
                            y: finalY,
                            width: finalWidth,
                            height: finalHeight,
                            color: PDFLib.rgb(0, 0, 0),
                            borderColor: PDFLib.rgb(0, 0, 0),
                            borderWidth: 5,
                            opacity: 1
                        });
                    });
                }

                const pdfBytes = await pdfLibDoc.save();
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });

                // Store the redacted file for workflow continuation
                redactedFile = new File([blob], 'redacted_' + currentFile.name, { type: 'application/pdf' });

                // Show success state (NO auto-download)
                processingState.style.display = 'none';
                workspace.classList.remove('active');
                successState.classList.add('active');

            } catch (error) {
                console.error('Error applying redaction:', error);
                alert('Error applying redaction: ' + error.message);
                processingState.style.display = 'none';
            }
        });

        // Download Redacted PDF button
        document.getElementById('downloadRedactedBtn').addEventListener('click', () => {
            if (redactedFile) {
                const url = URL.createObjectURL(redactedFile);
                const a = document.createElement('a');
                a.href = url;
                a.download = redactedFile.name;
                a.click();
                URL.revokeObjectURL(url);
            }
        });

        // Redact Another button
        document.getElementById('redactAnotherBtn').addEventListener('click', () => {
            // Reset the page
            location.reload();
        });

        // Continue workflow buttons
        const continueButtons = document.querySelectorAll('.continue-tool-btn');
        continueButtons.forEach(button => {
            button.addEventListener('click', function() {
                const targetTool = this.getAttribute('data-tool');

                if (redactedFile) {
                    // Store the redacted PDF file in sessionStorage for the next page
                    const reader = new FileReader();
                    reader.onloadend = function() {
                        const base64data = reader.result;
                        const fileData = {
                            name: redactedFile.name,
                            type: redactedFile.type,
                            data: base64data,
                            from: 'redact-pdf'
                        };
                        sessionStorage.setItem('continuedFile', JSON.stringify(fileData));

                        // Navigate to the target tool
                        window.location.href = `${targetTool}.html`;
                    };
                    reader.readAsDataURL(redactedFile);
                }
            });
        });

            // Expose handleFile globally for URL import functionality
            window.handleImportedFile = handleFile;
        }); // End of DOMContentLoaded
    </script>
</body>
</html>
